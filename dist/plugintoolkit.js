(function(s,u){typeof exports=="object"&&typeof module<"u"?u(exports,require("deepmerge")):typeof define=="function"&&define.amd?define(["exports","deepmerge"],u):(s=typeof globalThis<"u"?globalThis:s||self,u(s.RevealPluginToolkit={},s.deepmerge))})(this,function(s,u){"use strict";var T=Object.defineProperty;var L=(s,u,i)=>u in s?T(s,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[u]=i;var r=(s,u,i)=>L(s,typeof u!="symbol"?u+"":u,i);var i=typeof document<"u"?document.currentScript:null;class g{constructor(e,t,n){r(this,"defaultConfig");r(this,"pluginInit");r(this,"pluginId");r(this,"mergedConfig",null);r(this,"data",{});typeof e=="string"?(this.pluginId=e,this.pluginInit=t,this.defaultConfig=n||{}):(this.pluginId=e.id,this.pluginInit=e.init,this.defaultConfig=e.defaultConfig||{})}initializeConfig(e){const t=this.defaultConfig,o=e.getConfig()[this.pluginId]||{};this.mergedConfig=u(t,o,{arrayMerge:(c,d)=>d,clone:!0})}getCurrentConfig(){if(!this.mergedConfig)throw new Error("Plugin configuration has not been initialized");return this.mergedConfig}getData(){return Object.keys(this.data).length>0?this.data:void 0}init(e){if(this.initializeConfig(e),this.pluginInit)return this.pluginInit(this,e,this.getCurrentConfig())}createInterface(e={}){return{id:this.pluginId,init:n=>this.init(n),getConfig:()=>this.getCurrentConfig(),getData:()=>this.getData(),...e}}}const p=l=>{const e=document.querySelector(`script[src$="${l}.js"], script[src$="${l}.min.js"], script[src$="${l}.mjs"]`);if(e!=null&&e.src){const t=e.getAttribute("src")||"",n=t.lastIndexOf("/");if(n!==-1)return t.substring(0,n+1)}try{if(typeof{url:typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:i&&i.tagName.toUpperCase()==="SCRIPT"&&i.src||new URL("plugintoolkit.js",document.baseURI).href}<"u"&&(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:i&&i.tagName.toUpperCase()==="SCRIPT"&&i.src||new URL("plugintoolkit.js",document.baseURI).href))return(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:i&&i.tagName.toUpperCase()==="SCRIPT"&&i.src||new URL("plugintoolkit.js",document.baseURI).href).slice(0,(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:i&&i.tagName.toUpperCase()==="SCRIPT"&&i.src||new URL("plugintoolkit.js",document.baseURI).href).lastIndexOf("/")+1)}catch{}return`plugin/${l}/`},h="data-css-id",b=(l,e)=>new Promise((t,n)=>{const o=document.createElement("link");o.rel="stylesheet",o.href=e,o.setAttribute(h,l);const c=setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o),n(new Error(`[${l}] Timeout loading CSS from: ${e}`))},5e3);o.onload=()=>{clearTimeout(c),t()},o.onerror=()=>{clearTimeout(c),o.parentNode&&o.parentNode.removeChild(o),n(new Error(`[${l}] Failed to load CSS from: ${e}`))},document.head.appendChild(o)}),C=l=>document.querySelectorAll(`[${h}="${l}"]`).length>0,y=async l=>{const{id:e,cssautoload:t=!0,csspath:n="",debug:o=!1}=l;if(t===!1||n===!1)return;if(C(e)){o&&console.log(`[${e}] CSS already loaded, skipping`);return}const c=[];typeof n=="string"&&n.trim()!==""&&c.push(n);const d=p(e);if(d){const f=`${d}${e}.css`;c.push(f)}const S=`plugin/${e}/${e}.css`;c.push(S);for(const f of c)try{await b(e,f);let a="CSS";n&&f===n?a="user-specified CSS":d&&f===`${d}${e}.css`?a="CSS (auto-detected from script location)":a="CSS (standard fallback)",o&&console.log(`[${e}] ${a} loaded successfully from: ${f}`);return}catch{o&&console.log(`[${e}] Failed to load CSS from: ${f}`)}console.warn(`[${e}] Could not load CSS from any location`)};class m{constructor(){r(this,"debugMode",!1);r(this,"label","DEBUG");r(this,"groupDepth",0);r(this,"group",(...e)=>{this.debugLog("group",...e),this.groupDepth++});r(this,"groupCollapsed",(...e)=>{this.debugLog("groupCollapsed",...e),this.groupDepth++});r(this,"groupEnd",()=>{this.groupDepth>0&&(this.groupDepth--,this.debugLog("groupEnd"))});r(this,"error",(...e)=>{const t=this.debugMode;this.debugMode=!0,this.formatAndLog(console.error,e),this.debugMode=t});r(this,"table",(e,t,n)=>{if(this.debugMode)try{typeof e=="string"&&t!==void 0&&typeof t!="string"?(this.groupDepth===0?console.log(`[${this.label}]: ${e}`):console.log(e),n?console.table(t,n):console.table(t)):(this.groupDepth===0&&console.log(`[${this.label}]: Table data`),typeof t=="object"&&Array.isArray(t)?console.table(e,t):console.table(e))}catch(o){console.error(`[${this.label}]: Error showing table:`,o),console.log(`[${this.label}]: Raw data:`,e)}});r(this,"formatAndLog",(e,t)=>{if(this.debugMode)try{this.groupDepth>0?e.call(console,...t):t.length>0&&typeof t[0]=="string"?e.call(console,`[${this.label}]: ${t[0]}`,...t.slice(1)):e.call(console,`[${this.label}]:`,...t)}catch(n){console.error(`[${this.label}]: Error in logging:`,n),console.log(`[${this.label}]: Original log data:`,...t)}})}initialize(e,t="DEBUG"){this.debugMode=e,this.label=t}debugLog(e,...t){const n=console[e];if(!this.debugMode&&e!=="error"||typeof n!="function")return;const o=n;if(e==="group"||e==="groupCollapsed"){t.length>0&&typeof t[0]=="string"?o.call(console,`[${this.label}]: ${t[0]}`,...t.slice(1)):o.call(console,`[${this.label}]:`,...t);return}if(e==="groupEnd"){o.call(console);return}if(e==="table"){t.length===1?this.table(t[0]):t.length===2?typeof t[0]=="string"?this.table(t[0],t[1]):this.table(t[0],t[1]):t.length>=3&&this.table(t[0],t[1],t[2]);return}this.groupDepth>0?o.call(console,...t):t.length>0&&typeof t[0]=="string"?o.call(console,`[${this.label}]: ${t[0]}`,...t.slice(1)):o.call(console,`[${this.label}]:`,...t)}}const $=(l=>new Proxy(l,{get:(e,t)=>{if(t in e)return e[t];const n=t.toString();if(typeof console[n]=="function")return(...o)=>{e.debugLog(n,...o)}}}))(new m);s.PluginBase=g,s.pluginCSS=y,s.pluginDebug=$,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
